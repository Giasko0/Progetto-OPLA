<div id="formEsameContainer" class="popup">
  <div class="popup-header">
    <h2>Inserisci Esame</h2>
    <span id="closeOverlay" class="popup-close">&times;</span>
  </div>
  <div class="popup-body">
    <form id="formEsame" method="post">

      <!-- Pannello preferenze -->
      <div id="preferencesPanel" class="preferences-panel">
        <div class="preferences-header">
          <span>Preferenze</span>
          <button type="button" id="savePreferenceBtn" class="preference-btn" title="Salva preferenza"><span class="material-symbols-outlined">save</span></button>
          <button type="button" id="loadPreferenceBtn" class="preference-btn" title="Carica preferenza"><span class="material-symbols-outlined">folder_open</span></button>
        </div>
        <div id="preferencesMenu" class="preferences-menu" style="display: none;"></div>
        <div id="savePreferenceForm" class="preferences-form" style="display: none;">
          <input type="text" id="preferenceNameInput" placeholder="Nome preferenza">
          <button type="button" id="confirmSavePreference">Salva</button>
          <button type="button" id="cancelSavePreference">Annulla</button>
        </div>
      </div>

      <p style="margin: 0; float: right">* Campi obbligatori</p>

      <!-- Hidden values -->
      <input type="text" id="docente" name="docente" hidden>
      <input type="text" id="anno_accademico" name="anno_accademico" hidden>

      <div class="checkbox-container">
        <label for="provaParziale">Prova parziale:</label>
        <input type="checkbox" id="provaParziale" name="provaParziale">
      </div>

      <label for="descrizione">Descrizione*</label>
      <input type="text" id="descrizione" name="descrizione" placeholder="Inserisci una descrizione" value="Placeholder"
        required>

      <label for="insegnamento">Insegnamenti*</label>
      <div class="multi-select-container">
        <div id="insegnamentoBox" class="multi-select-box">
          <span class="multi-select-placeholder">Seleziona gli insegnamenti</span>
        </div>
        <div id="insegnamentoDropdown" class="multi-select-dropdown">
          <div id="insegnamentoOptions"></div>
        </div>
        <select id="insegnamento" name="insegnamento" multiple class="multi-select-hidden" required></select>
      </div>

      <label for="dataora">Data Appello*</label>
      <input type="date" id="dataora" name="dataora" required>

      <label for="ora">Ora Appello*</label>
      <input type="time" id="ora" name="ora" min="08:00" max="23:00" step="900" required>

      <label for="aula">Aule disponibili*</label>
      <select id="aula" name="aula" required>
        <option value="" disabled selected hidden>Seleziona prima data e ora</option>
      </select>

      <label for="durata">Durata (in minuti)*</label>
      <input type="number" id="durata" name="durata" min="30" max="480" step="15" value="120" required>

      <label for="verbalizzazione">Verbalizzazione*</label>
      <select id="verbalizzazione" name="verbalizzazione">
        <option value="FSS" selected>Firma digitale singola</option>
        <option value="FWP">Firma digitale con pubblicazione</option>
      </select>

      <span id="buttonOpzioniAvanzate">Opzioni avanzate <span class="material-symbols-outlined">arrow_right</span></span>

      <!-- Opzioni avanzate -->
      <div id="opzioniAvanzate">
        <div>
          <label for="inizioIscrizione">Data inizio iscrizione</label>
          <input type="date" id="inizioIscrizione" name="inizioIscrizione">
        </div>

        <div>
          <label for="fineIscrizione">Data fine iscrizione</label>
          <input type="date" id="fineIscrizione" name="fineIscrizione">
        </div>

        <div>
          <label for="tipoEsame">Tipo esame</label>
          <select id="tipoEsame" name="tipoEsame">
            <option value="" disabled selected hidden>Non definito</option>
            <option value="S">Scritto</option>
            <option value="O">Orale</option>
            <option value="SO">Scritto e orale</option>
          </select>
        </div>

        <div>
          <label for="posti">Posti</label>
          <input type="number" id="posti" name="posti" min="1">
        </div>

        <div>
          <label for="note">Note</label>
          <textarea id="note" name="note" rows="2"></textarea>
        </div>

        <span>
          Se non si inseriscono date inizio/fine iscrizione, il sistema le imposter√† automaticamente a 20 giorni
          dall'inizio sessione fino al giorno prima dell'esame.
        </span>

        <!--
        <div>
          <label class="formEsame-label" for="tipoAppello">Tipo appello</label>
          <select id="tipoAppello" name="tipoAppello">
            <option value="PF" selected>PF</option>
          </select>
        </div>
        <div>
          <label class="formEsame-label" for="riservato">Riservato</label>
          <input type="checkbox" id="riservato" name="riservato">  
        </div>
        <div>
          <label class="formEsame-label" for="definizioneAppello">Definizione appello</label>
          <select id="definizioneAppello" name="definizioneAppello">
            <option value="STD" selected>Standard</option>
          </select>
        </div>
        <div>
          <label class="formEsame-label" for="gestionePrenotazione">Gestione pren.</label>
          <select id="gestionePrenotazione" name="gestionePrenotazione">
            <option value="STD" selected>Standard</option>
          </select>  
        </div>
        -->

      </div>

      <div class="form-actions">
        <button type="submit" class="invia">Invia</button>
        <button type="button" id="bypassChecksBtn" class="invia secondary">Invia senza controlli</button>
      </div>
    </form>
  </div>
</div>