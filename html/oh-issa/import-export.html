<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Strumenti di importazione ed esportazione dati per il sistema OH-ISSA dell'UniversitÃ  degli Studi di Perugia. Importa dati da UGOV, carica aule da EasyAcademy ed esporta file per ESSE3.">
  <title>Import/Export - OH-ISSA</title>
  <link rel="icon" type="image/x-icon" href="static/imgs/favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link rel="stylesheet" href="static/styles/admin.css">
  <script src="static/scripts/authCheck.js"></script>
  <script src="static/scripts/navbarAdmin.js"></script>
  <script src="static/scripts/footerAdmin.js"></script>
  <script src="static/scripts/import-export.js"></script>
</head>

<body>
  <div id="navbar"></div>

  <main>
    <h1>Import/Export Dati</h1>

    <!-- Selettore Anno Accademico -->
    <section class="anno-selector">
      <h3>Selezione Anno Accademico</h3>
      <div class="anno-controls">
        <div>
          <select id="annoSelect">
            <option value="">Caricamento...</option>
          </select>
        </div>
        <div id="statusIndicator" class="status-indicator loading">
          <span id="statusText">Verifico stato programmazione...</span>
        </div>
      </div>
    </section>

    <h2>Import Dati</h2>

    <section class="upload-section">
      <fieldset>
        <legend>Import U-GOV</legend>
        <p>Carica un file Excel esportato da U-GOV contenente l'elenco dei docenti e degli insegnamenti</p>
        <div class="file-upload">
          <input type="file" id="fileInput" name="file" accept=".xls,.xlsx" style="display: none;">
          <button id="uploadFileButton" type="button" class="btn primary">Seleziona e Carica File</button>
          <span id="selectedFileName">Nessun file selezionato</span>
        </div>
      </fieldset>
    </section>
    
    <h2>Export Dati</h2>

    <section class="upload-section">
      <fieldset>
        <legend>Export ESSE3</legend>
        <p>Scarica il file XLS contenente tutti gli esami nel formato richiesto da ESSE3.</p>
        <button id="downloadButton" class="btn primary">Scarica File ESSE3</button>
      </fieldset>
    </section>

    <section class="upload-section">
      <fieldset>
        <legend>Export EasyAcademy</legend>
        <p>Scarica il file XLS contenente le aule occupate nel formato richiesto da EasyAcademy.</p>
        <div class="export-options">
          <label for="eaExportToggle">
            <input type="checkbox" id="eaExportToggle" checked>
            Includi le informazioni su insegnamenti e docenti
          </label>
        </div>
        <button id="downloadEasyAcademyButton" class="btn primary">Scarica File EasyAcademy</button>
      </fieldset>
    </section>

    <div id="responseMessages"></div>
  </main>
  
  <footer id="footer"></footer>
</body>

</html>