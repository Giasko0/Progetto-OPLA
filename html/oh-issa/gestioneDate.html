<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Gestione delle Date di Sessioni d'Esame nel sistema OH-ISSA dell'Università degli Studi di Perugia. Configura date dei semestri, pause didattiche e sessioni d'esame per ogni corso.">
  <title>Gestione Date - OH-ISSA</title>
  <link rel="icon" type="image/x-icon" href="static/imgs/favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
  <link rel="stylesheet" href="static/styles/admin.css">
  <script src="static/scripts/authCheck.js"></script>
  <script src="static/scripts/navbarAdmin.js"></script>
  <script src="static/scripts/footerAdmin.js"></script>
  <script src="static/scripts/gestioneDate.js"></script>
</head>

<body>
  <div id="navbar"></div>

  <main>
    <h1>Gestione Date per Corso di Studio</h1>

    <!-- Sezione per selezionare anno e corso in due colonne -->
    <section class="selector-section">
      <div class="columns-container">
        <div class="column">
          <label for="selectAnnoAccademico">Anno Accademico:</label>
          <select id="selectAnnoAccademico" onchange="loadCorsiForAnno(this.value)">
            <option value="">Seleziona anno accademico</option>
            <!-- Opzioni caricate dinamicamente -->
          </select>
        </div>
        <div class="column">
          <label for="selectCds">Corso di Studio:</label>
          <div class="custom-dropdown" id="cdsDropdownContainer">
            <div class="dropdown-header" id="cdsDropdownHeader">
              <span id="cdsDropdownText">Seleziona uno o più corsi</span>
              <span class="dropdown-arrow">▼</span>
            </div>
            <div class="dropdown-options" id="cdsDropdownOptions">
              <!-- Opzioni caricate dinamicamente -->
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="form-section" id="cdsFormContainer" style="display: none;">
      <h2>Modifica Sessioni d'Esame</h2>

      <!-- Informazioni del corso (solo visualizzazione) -->
      <div id="cdsInfoContainer" class="info-container">
        <!-- Il contenuto verrà generato dinamicamente da JavaScript -->
      </div>

      <form id="cdsForm">
        <!-- Campi nascosti per informazioni del corso -->
        <input type="hidden" id="codice" name="codice_cds">
        <input type="hidden" id="anno_accademico" name="anno_accademico">
        <input type="hidden" id="nome_corso" name="nome_corso">

        <!-- Sessioni d'esame -->
        <fieldset>
          <legend>Sessioni d'Esame</legend>

          <div class="session-group">
            <h4>Sessione Anticipata</h4>
            <div class="session-dates">
              <div>
                <label for="anticipata_inizio">Inizio:</label>
                <input type="date" id="anticipata_inizio" name="anticipata_inizio">
              </div>
              <div>
                <label for="anticipata_fine">Fine:</label>
                <input type="date" id="anticipata_fine" name="anticipata_fine">
              </div>
              <div>
                <label for="anticipata_esami_primo">Min. esami insegn. 1° sem:</label>
                <input type="number" id="anticipata_esami_primo" name="anticipata_esami_primo" min="0">
              </div>
            </div>
            <small class="form-text">Corrisponde alla sessione invernale dell'anno accademico precedente</small>
          </div>

          <div class="session-group">
            <h4>Sessione Estiva</h4>
            <div class="session-dates">
              <div>
                <label for="estiva_inizio">Inizio:</label>
                <input type="date" id="estiva_inizio" name="estiva_inizio">
              </div>
              <div>
                <label for="estiva_fine">Fine:</label>
                <input type="date" id="estiva_fine" name="estiva_fine">
              </div>
              <div>
                <label for="estiva_esami_primo">Min. esami insegn. 1° sem:</label>
                <input type="number" id="estiva_esami_primo" name="estiva_esami_primo" min="0">
              </div>
              <div>
                <label for="estiva_esami_secondo">Min. esami insegn. 2° sem:</label>
                <input type="number" id="estiva_esami_secondo" name="estiva_esami_secondo" min="0">
              </div>
            </div>
          </div>

          <div class="session-group">
            <h4>Sessione Autunnale</h4>
            <div class="session-dates">
              <div>
                <label for="autunnale_inizio">Inizio:</label>
                <input type="date" id="autunnale_inizio" name="autunnale_inizio">
              </div>
              <div>
                <label for="autunnale_fine">Fine:</label>
                <input type="date" id="autunnale_fine" name="autunnale_fine">
              </div>
              <div>
                <label for="autunnale_esami_primo">Min. esami insegn. 1° sem:</label>
                <input type="number" id="autunnale_esami_primo" name="autunnale_esami_primo" min="0">
              </div>
              <div>
                <label for="autunnale_esami_secondo">Min. esami insegn. 2° sem:</label>
                <input type="number" id="autunnale_esami_secondo" name="autunnale_esami_secondo" min="0">
              </div>
            </div>
          </div>

          <div class="session-group">
            <h4>Sessione Invernale</h4>
            <div class="session-dates">
              <div>
                <label for="invernale_inizio">Inizio:</label>
                <input type="date" id="invernale_inizio" name="invernale_inizio">
              </div>
              <div>
                <label for="invernale_fine">Fine:</label>
                <input type="date" id="invernale_fine" name="invernale_fine">
              </div>
              <div>
                <label for="invernale_esami_primo">Min. esami insegn. 1° sem:</label>
                <input type="number" id="invernale_esami_primo" name="invernale_esami_primo" min="0">
              </div>
              <div>
                <label for="invernale_esami_secondo">Min. esami insegn. 2° sem:</label>
                <input type="number" id="invernale_esami_secondo" name="invernale_esami_secondo" min="0">
              </div>
            </div>
          </div>
        </fieldset>

        <div class="actions">
          <button type="submit" class="btn primary">Salva</button>
          <button type="button" id="resetForm" class="btn">Annulla</button>
          <button type="button" id="copyDatesBtn" class="btn">Copia date da altro CdS</button>
        </div>
      </form>
    </section>

    <div id="responseMessages"></div>
  </main>

  <footer id="footer"></footer>

  <!-- Modal per copiare date da altro CdS -->
  <div id="copyDatesModal" class="modal">
    <div class="modal-content">
      <h2>Copia date da altro CdS</h2>
      <p>Seleziona il Corso di Studio da cui copiare le date:</p>
      
      <div class="form-group">
        <label for="sourceCdsYear">Anno Accademico:</label>
        <select id="sourceCdsYear">
          <option value="">Seleziona anno accademico</option>
          <!-- Opzioni caricate dinamicamente -->
        </select>
      </div>
      
      <div class="form-group">
        <label for="sourceCds">Corso di Studio:</label>
        <select id="sourceCds">
          <option value="">Seleziona un corso</option>
          <!-- Opzioni caricate dinamicamente -->
        </select>
      </div>
      
      <div class="modal-actions">
        <button id="confirmCopy" class="btn primary">Copia</button>
        <button id="cancelCopy" class="btn">Annulla</button>
      </div>
    </div>
  </div>

  <!-- Modal per confermare il reset del form -->
  <div id="resetConfirmModal" class="modal">
    <div class="modal-content">
      <h2>Conferma reset</h2>
      <p>Sei sicuro di voler annullare le modifiche e ripristinare i dati originali?</p>
      
      <div class="modal-actions">
        <button id="confirmReset" class="btn primary">Conferma</button>
        <button id="cancelReset" class="btn">Annulla</button>
      </div>
    </div>
  </div>
</body>

</html>